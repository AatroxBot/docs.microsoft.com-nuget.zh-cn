---
title: 目录资源，NuGet V3 API
description: 目录是在 nuget.org 上创建和删除的所有包的索引。
author: joelverhagen
ms.author: jver
ms.date: 10/30/2017
ms.topic: reference
ms.reviewer: kraigb
ms.openlocfilehash: ffbcb8dc18542f39c32a6d84b279c8eccaf98fc3
ms.sourcegitcommit: 7e9c0630335ef9ec1e200e2ee9065f702e52a8ec
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 06/24/2020
ms.locfileid: "85292303"
---
# <a name="catalog"></a><span data-ttu-id="0a0db-103">目录</span><span class="sxs-lookup"><span data-stu-id="0a0db-103">Catalog</span></span>

<span data-ttu-id="0a0db-104">**目录**是记录包源上所有包操作（如创建和删除）的资源。</span><span class="sxs-lookup"><span data-stu-id="0a0db-104">The **catalog** is a resource that records all package operations on a package source, such as creations and deletions.</span></span> <span data-ttu-id="0a0db-105">目录资源的 `Catalog` [服务索引](service-index.md)中包含类型。</span><span class="sxs-lookup"><span data-stu-id="0a0db-105">The catalog resource has the `Catalog` type in the [service index](service-index.md).</span></span> <span data-ttu-id="0a0db-106">您可以使用此资源[查询所有已发布的包](../guides/api/query-for-all-published-packages.md)。</span><span class="sxs-lookup"><span data-stu-id="0a0db-106">You can use this resource to [query for all published packages](../guides/api/query-for-all-published-packages.md).</span></span>

> [!Note]
> <span data-ttu-id="0a0db-107">由于官方 NuGet 客户端不使用目录，因此并非所有包源都实现目录。</span><span class="sxs-lookup"><span data-stu-id="0a0db-107">Because the catalog is not used by the official NuGet client, not all package sources implement the catalog.</span></span>

> [!Note]
> <span data-ttu-id="0a0db-108">目前，nuget.org 目录在中国不可用。</span><span class="sxs-lookup"><span data-stu-id="0a0db-108">Currently, the nuget.org catalog is not available in China.</span></span> <span data-ttu-id="0a0db-109">有关更多详细信息，请参阅[NuGet/NuGetGallery # 4949](https://github.com/NuGet/NuGetGallery/issues/4949)。</span><span class="sxs-lookup"><span data-stu-id="0a0db-109">For more details, see [NuGet/NuGetGallery#4949](https://github.com/NuGet/NuGetGallery/issues/4949).</span></span>

## <a name="versioning"></a><span data-ttu-id="0a0db-110">版本控制</span><span class="sxs-lookup"><span data-stu-id="0a0db-110">Versioning</span></span>

<span data-ttu-id="0a0db-111">使用以下 `@type` 值：</span><span class="sxs-lookup"><span data-stu-id="0a0db-111">The following `@type` value is used:</span></span>

<span data-ttu-id="0a0db-112">@type 值</span><span class="sxs-lookup"><span data-stu-id="0a0db-112">@type value</span></span>   | <span data-ttu-id="0a0db-113">备注</span><span class="sxs-lookup"><span data-stu-id="0a0db-113">Notes</span></span>
------------- | -----
<span data-ttu-id="0a0db-114">Catalog/3.0。0</span><span class="sxs-lookup"><span data-stu-id="0a0db-114">Catalog/3.0.0</span></span> | <span data-ttu-id="0a0db-115">初始版本</span><span class="sxs-lookup"><span data-stu-id="0a0db-115">The initial release</span></span>

## <a name="base-url"></a><span data-ttu-id="0a0db-116">基 URL</span><span class="sxs-lookup"><span data-stu-id="0a0db-116">Base URL</span></span>

<span data-ttu-id="0a0db-117">以下 Api 的入口点 URL 是 `@id` 与上述资源值关联的属性的值 `@type` 。</span><span class="sxs-lookup"><span data-stu-id="0a0db-117">The entry point URL for the following APIs is the value of the `@id` property associated with the aforementioned resource `@type` values.</span></span> <span data-ttu-id="0a0db-118">本主题使用占位符 URL `{@id}` 。</span><span class="sxs-lookup"><span data-stu-id="0a0db-118">This topic uses the placeholder URL `{@id}`.</span></span>

## <a name="http-methods"></a><span data-ttu-id="0a0db-119">HTTP 方法</span><span class="sxs-lookup"><span data-stu-id="0a0db-119">HTTP methods</span></span>

<span data-ttu-id="0a0db-120">在目录资源中找到的所有 Url 仅支持 HTTP 方法 `GET` 和 `HEAD` 。</span><span class="sxs-lookup"><span data-stu-id="0a0db-120">All URLs found in the catalog resource support only the HTTP methods `GET` and `HEAD`.</span></span>

## <a name="catalog-index"></a><span data-ttu-id="0a0db-121">目录索引</span><span class="sxs-lookup"><span data-stu-id="0a0db-121">Catalog index</span></span>

<span data-ttu-id="0a0db-122">目录索引是众所周知位置的文档，其中包含目录项列表，按时间顺序排列。</span><span class="sxs-lookup"><span data-stu-id="0a0db-122">The catalog index is a document in a well-known location that has a list of catalog items, ordered chronologically.</span></span> <span data-ttu-id="0a0db-123">它是目录资源的入口点。</span><span class="sxs-lookup"><span data-stu-id="0a0db-123">It is the entry point of the catalog resource.</span></span>

<span data-ttu-id="0a0db-124">此索引由目录页组成。</span><span class="sxs-lookup"><span data-stu-id="0a0db-124">The index is comprised of catalog pages.</span></span> <span data-ttu-id="0a0db-125">每个目录页面都包含目录项。</span><span class="sxs-lookup"><span data-stu-id="0a0db-125">Each catalog page contains catalog items.</span></span> <span data-ttu-id="0a0db-126">每个目录项都表示一个事件，该事件涉及到某个时间点的单个包。</span><span class="sxs-lookup"><span data-stu-id="0a0db-126">Each catalog item represents an event concerning a single package at a point in time.</span></span> <span data-ttu-id="0a0db-127">目录项可以表示从包源创建、未列出、重新列出或删除的包。</span><span class="sxs-lookup"><span data-stu-id="0a0db-127">A catalog item can represent a package that was created, unlisted, relisted, or deleted from the package source.</span></span> <span data-ttu-id="0a0db-128">通过按时间顺序处理目录项，客户端可以生成在 V3 包源上存在的每个包的最新视图。</span><span class="sxs-lookup"><span data-stu-id="0a0db-128">By processing the catalog items in chronological order, the client can build an up-to-date view of every package that exists on the V3 package source.</span></span>

<span data-ttu-id="0a0db-129">简而言之，目录 blob 具有以下层次结构：</span><span class="sxs-lookup"><span data-stu-id="0a0db-129">In short, catalog blobs have the following hierarchical structure:</span></span>

- <span data-ttu-id="0a0db-130">**Index**：目录的入口点。</span><span class="sxs-lookup"><span data-stu-id="0a0db-130">**Index**: the entry point for the catalog.</span></span>
- <span data-ttu-id="0a0db-131">**页面**：目录项的分组。</span><span class="sxs-lookup"><span data-stu-id="0a0db-131">**Page**: a grouping of catalog items.</span></span>
- <span data-ttu-id="0a0db-132">**叶**：表示目录项的文档，该目录项是单个包状态的快照。</span><span class="sxs-lookup"><span data-stu-id="0a0db-132">**Leaf**: a document representing a catalog item, which is a snapshot of a single package's state.</span></span>

<span data-ttu-id="0a0db-133">每个目录对象都有一个名为的属性，该属性 `commitTimeStamp` 表示将项添加到目录的时间。</span><span class="sxs-lookup"><span data-stu-id="0a0db-133">Each catalog object has a property called the `commitTimeStamp` representing when the item was added to the catalog.</span></span> <span data-ttu-id="0a0db-134">目录项将添加到名为 "提交" 的批次的目录页中。</span><span class="sxs-lookup"><span data-stu-id="0a0db-134">Catalog items are added to a catalog page in batches called commits.</span></span> <span data-ttu-id="0a0db-135">同一提交中的所有目录项都具有相同的提交时间戳（ `commitTimeStamp` ）和提交 ID （ `commitId` ）。</span><span class="sxs-lookup"><span data-stu-id="0a0db-135">All catalog items in the same commit have the same commit timestamp (`commitTimeStamp`) and commit ID (`commitId`).</span></span> <span data-ttu-id="0a0db-136">放置在同一提交中的目录项表示在包源上的同一时间点附近发生的事件。</span><span class="sxs-lookup"><span data-stu-id="0a0db-136">Catalog items placed in the same commit represent events that happened around the same point in time on the package source.</span></span> <span data-ttu-id="0a0db-137">目录提交中没有排序。</span><span class="sxs-lookup"><span data-stu-id="0a0db-137">There is no ordering within a catalog commit.</span></span>

<span data-ttu-id="0a0db-138">由于每个包 ID 和版本都是唯一的，因此在一个提交中将永远不会有多个目录项。</span><span class="sxs-lookup"><span data-stu-id="0a0db-138">Because each package ID and version is unique, there will never be more than one catalog item in a commit.</span></span> <span data-ttu-id="0a0db-139">这可确保单个包的目录项始终可以明确地按提交时间戳进行排序。</span><span class="sxs-lookup"><span data-stu-id="0a0db-139">This ensures that catalog items for a single package can always be unambiguously ordered with respect to commit timestamp.</span></span>

<span data-ttu-id="0a0db-140">每个目录的提交永远不会超过一个 `commitTimeStamp` 。</span><span class="sxs-lookup"><span data-stu-id="0a0db-140">There is never be more than one commit to the catalog per `commitTimeStamp`.</span></span> <span data-ttu-id="0a0db-141">换言之， `commitId` 是的冗余 `commitTimeStamp` 。</span><span class="sxs-lookup"><span data-stu-id="0a0db-141">In other words, the `commitId` is redundant with the `commitTimeStamp`.</span></span>

<span data-ttu-id="0a0db-142">与按包 ID 编制索引的[包元数据资源](registration-base-url-resource.md)不同，目录仅通过时间进行索引（和查询）。</span><span class="sxs-lookup"><span data-stu-id="0a0db-142">In contrast to the [package metadata resource](registration-base-url-resource.md), which is indexed by package ID, the catalog is indexed (and queryable) only by time.</span></span>

<span data-ttu-id="0a0db-143">目录项始终按单调递增的时间顺序添加到目录中。</span><span class="sxs-lookup"><span data-stu-id="0a0db-143">Catalog items are always added to the catalog in a monotonically increasing, chronological order.</span></span> <span data-ttu-id="0a0db-144">这意味着，如果在时间 X 添加目录提交，则不会使用小于或等于 X 的时间来添加目录提交。</span><span class="sxs-lookup"><span data-stu-id="0a0db-144">This means that if a catalog commit is added at time X then no catalog commit will ever be added with a time less than or equal to X.</span></span>

<span data-ttu-id="0a0db-145">以下请求将获取目录索引。</span><span class="sxs-lookup"><span data-stu-id="0a0db-145">The following request fetches the catalog index.</span></span>

    GET {@id}

<span data-ttu-id="0a0db-146">目录索引是一个 JSON 文档，其中包含具有以下属性的对象：</span><span class="sxs-lookup"><span data-stu-id="0a0db-146">The catalog index is a JSON document that contains an object with the following properties:</span></span>

<span data-ttu-id="0a0db-147">名称</span><span class="sxs-lookup"><span data-stu-id="0a0db-147">Name</span></span>            | <span data-ttu-id="0a0db-148">类型</span><span class="sxs-lookup"><span data-stu-id="0a0db-148">Type</span></span>             | <span data-ttu-id="0a0db-149">必需</span><span class="sxs-lookup"><span data-stu-id="0a0db-149">Required</span></span> | <span data-ttu-id="0a0db-150">备注</span><span class="sxs-lookup"><span data-stu-id="0a0db-150">Notes</span></span>
--------------- | ---------------- | -------- | -----
<span data-ttu-id="0a0db-151">commitId</span><span class="sxs-lookup"><span data-stu-id="0a0db-151">commitId</span></span>        | <span data-ttu-id="0a0db-152">字符串</span><span class="sxs-lookup"><span data-stu-id="0a0db-152">string</span></span>           | <span data-ttu-id="0a0db-153">是</span><span class="sxs-lookup"><span data-stu-id="0a0db-153">yes</span></span>      | <span data-ttu-id="0a0db-154">与最新提交关联的唯一 ID</span><span class="sxs-lookup"><span data-stu-id="0a0db-154">A unique ID associated with the most recent commit</span></span>
<span data-ttu-id="0a0db-155">commitTimeStamp</span><span class="sxs-lookup"><span data-stu-id="0a0db-155">commitTimeStamp</span></span> | <span data-ttu-id="0a0db-156">字符串</span><span class="sxs-lookup"><span data-stu-id="0a0db-156">string</span></span>           | <span data-ttu-id="0a0db-157">是</span><span class="sxs-lookup"><span data-stu-id="0a0db-157">yes</span></span>      | <span data-ttu-id="0a0db-158">最近提交的时间戳</span><span class="sxs-lookup"><span data-stu-id="0a0db-158">A timestamp of the most recent commit</span></span>
<span data-ttu-id="0a0db-159">count</span><span class="sxs-lookup"><span data-stu-id="0a0db-159">count</span></span>           | <span data-ttu-id="0a0db-160">integer</span><span class="sxs-lookup"><span data-stu-id="0a0db-160">integer</span></span>          | <span data-ttu-id="0a0db-161">是</span><span class="sxs-lookup"><span data-stu-id="0a0db-161">yes</span></span>      | <span data-ttu-id="0a0db-162">索引中的页数</span><span class="sxs-lookup"><span data-stu-id="0a0db-162">The number of pages in the index</span></span>
<span data-ttu-id="0a0db-163">items</span><span class="sxs-lookup"><span data-stu-id="0a0db-163">items</span></span>           | <span data-ttu-id="0a0db-164">对象数组</span><span class="sxs-lookup"><span data-stu-id="0a0db-164">array of objects</span></span> | <span data-ttu-id="0a0db-165">是</span><span class="sxs-lookup"><span data-stu-id="0a0db-165">yes</span></span>      | <span data-ttu-id="0a0db-166">对象的数组，每个对象表示一个页</span><span class="sxs-lookup"><span data-stu-id="0a0db-166">A array of objects, each object representing a page</span></span>

<span data-ttu-id="0a0db-167">数组中的每个元素 `items` 都是一个对象，其中包含有关每个页面的一些最少的详细信息。</span><span class="sxs-lookup"><span data-stu-id="0a0db-167">Each element in the `items` array is an object with some minimal details about each page.</span></span> <span data-ttu-id="0a0db-168">这些页面对象不包含目录叶（items）。</span><span class="sxs-lookup"><span data-stu-id="0a0db-168">These page objects do not contain the catalog leaves (items).</span></span> <span data-ttu-id="0a0db-169">未定义此数组中元素的顺序。</span><span class="sxs-lookup"><span data-stu-id="0a0db-169">The order of the elements in this array is not defined.</span></span> <span data-ttu-id="0a0db-170">客户端可以使用其属性在内存中对页面进行排序 `commitTimeStamp` 。</span><span class="sxs-lookup"><span data-stu-id="0a0db-170">Pages can be ordered by the client in memory using their `commitTimeStamp` property.</span></span>

<span data-ttu-id="0a0db-171">随着新页的引入， `count` 将递增，新的对象将出现在数组中 `items` 。</span><span class="sxs-lookup"><span data-stu-id="0a0db-171">As new pages are introduced, the `count` will be incremented and new objects will appear in the `items` array.</span></span>

<span data-ttu-id="0a0db-172">在将项添加到目录中时，索引的 `commitId` 将会更改，并且 `commitTimeStamp` 将增加。</span><span class="sxs-lookup"><span data-stu-id="0a0db-172">As items are added to the catalog, the index's `commitId` will change and the `commitTimeStamp` will increase.</span></span> <span data-ttu-id="0a0db-173">这两个属性本质上是对 `commitId` 数组中所有页面和值的汇总 `commitTimeStamp` `items` 。</span><span class="sxs-lookup"><span data-stu-id="0a0db-173">These two properties are essentially a summary over all page `commitId` and `commitTimeStamp` values in the `items` array.</span></span>

### <a name="catalog-page-object-in-the-index"></a><span data-ttu-id="0a0db-174">索引中的目录页对象</span><span class="sxs-lookup"><span data-stu-id="0a0db-174">Catalog page object in the index</span></span>

<span data-ttu-id="0a0db-175">在目录索引的属性中找到的目录页对象 `items` 具有以下属性：</span><span class="sxs-lookup"><span data-stu-id="0a0db-175">The catalog page objects found in the catalog index's `items` property have the following properties:</span></span>

<span data-ttu-id="0a0db-176">名称</span><span class="sxs-lookup"><span data-stu-id="0a0db-176">Name</span></span>            | <span data-ttu-id="0a0db-177">类型</span><span class="sxs-lookup"><span data-stu-id="0a0db-177">Type</span></span>    | <span data-ttu-id="0a0db-178">必需</span><span class="sxs-lookup"><span data-stu-id="0a0db-178">Required</span></span> | <span data-ttu-id="0a0db-179">备注</span><span class="sxs-lookup"><span data-stu-id="0a0db-179">Notes</span></span>
--------------- | ------- | -------- | -----
@id             | <span data-ttu-id="0a0db-180">字符串</span><span class="sxs-lookup"><span data-stu-id="0a0db-180">string</span></span>  | <span data-ttu-id="0a0db-181">是</span><span class="sxs-lookup"><span data-stu-id="0a0db-181">yes</span></span>      | <span data-ttu-id="0a0db-182">要提取目录页的 URL</span><span class="sxs-lookup"><span data-stu-id="0a0db-182">The URL to fetch catalog page</span></span>
<span data-ttu-id="0a0db-183">commitId</span><span class="sxs-lookup"><span data-stu-id="0a0db-183">commitId</span></span>        | <span data-ttu-id="0a0db-184">字符串</span><span class="sxs-lookup"><span data-stu-id="0a0db-184">string</span></span>  | <span data-ttu-id="0a0db-185">是</span><span class="sxs-lookup"><span data-stu-id="0a0db-185">yes</span></span>      | <span data-ttu-id="0a0db-186">与此页中的最新提交关联的唯一 ID</span><span class="sxs-lookup"><span data-stu-id="0a0db-186">A unique ID associated with the most recent commit in this page</span></span>
<span data-ttu-id="0a0db-187">commitTimeStamp</span><span class="sxs-lookup"><span data-stu-id="0a0db-187">commitTimeStamp</span></span> | <span data-ttu-id="0a0db-188">字符串</span><span class="sxs-lookup"><span data-stu-id="0a0db-188">string</span></span>  | <span data-ttu-id="0a0db-189">是</span><span class="sxs-lookup"><span data-stu-id="0a0db-189">yes</span></span>      | <span data-ttu-id="0a0db-190">此页中的最新提交的时间戳</span><span class="sxs-lookup"><span data-stu-id="0a0db-190">A timestamp of the most recent commit in this page</span></span>
<span data-ttu-id="0a0db-191">count</span><span class="sxs-lookup"><span data-stu-id="0a0db-191">count</span></span>           | <span data-ttu-id="0a0db-192">integer</span><span class="sxs-lookup"><span data-stu-id="0a0db-192">integer</span></span> | <span data-ttu-id="0a0db-193">是</span><span class="sxs-lookup"><span data-stu-id="0a0db-193">yes</span></span>      | <span data-ttu-id="0a0db-194">目录页中的项数</span><span class="sxs-lookup"><span data-stu-id="0a0db-194">The number of items in the catalog page</span></span>

<span data-ttu-id="0a0db-195">与[包元数据资源](registration-base-url-resource.md)相比，在某些情况下，inlines 留在索引中，目录叶从不内联到索引中，必须始终使用页面的 URL 来提取 `@id` 。</span><span class="sxs-lookup"><span data-stu-id="0a0db-195">In contrast to the [package metadata resource](registration-base-url-resource.md) which in some cases inlines leaves into the index, catalog leaves are never inlined into the index and must always be fetched by using the page's `@id` URL.</span></span>

### <a name="sample-request"></a><span data-ttu-id="0a0db-196">示例请求</span><span class="sxs-lookup"><span data-stu-id="0a0db-196">Sample request</span></span>

    GET https://api.nuget.org/v3/catalog0/index.json

### <a name="sample-response"></a><span data-ttu-id="0a0db-197">示例响应</span><span class="sxs-lookup"><span data-stu-id="0a0db-197">Sample response</span></span>

[!code-JSON [catalog-index.json](./_data/catalog-index.json)]

## <a name="catalog-page"></a><span data-ttu-id="0a0db-198">目录页</span><span class="sxs-lookup"><span data-stu-id="0a0db-198">Catalog page</span></span>

<span data-ttu-id="0a0db-199">"目录" 页是目录项的集合。</span><span class="sxs-lookup"><span data-stu-id="0a0db-199">The catalog page is a collection of catalog items.</span></span> <span data-ttu-id="0a0db-200">它是使用 `@id` 目录索引中找到的值之一提取的文档。</span><span class="sxs-lookup"><span data-stu-id="0a0db-200">It is a document fetched using one of the `@id` values found in the catalog index.</span></span> <span data-ttu-id="0a0db-201">目录页的 URL 不应是可预测的，只应使用目录索引来发现。</span><span class="sxs-lookup"><span data-stu-id="0a0db-201">The URL to a catalog page is not intended to be predictable and should be discovered using only the catalog index.</span></span>

<span data-ttu-id="0a0db-202">新的目录项仅添加到具有最高提交时间戳或新页的目录索引页面。</span><span class="sxs-lookup"><span data-stu-id="0a0db-202">New catalog items are added to the page in the catalog index only with the highest commit timestamp or to a new page.</span></span> <span data-ttu-id="0a0db-203">将具有较高提交时间戳的页面添加到目录后，将永远不会将较旧的页面添加到或更改。</span><span class="sxs-lookup"><span data-stu-id="0a0db-203">Once a page with a higher commit timestamp is added to the catalog, older pages are never added to or changed.</span></span>

<span data-ttu-id="0a0db-204">目录页文档是包含以下属性的 JSON 对象：</span><span class="sxs-lookup"><span data-stu-id="0a0db-204">The catalog page document is a JSON object with the following properties:</span></span>

<span data-ttu-id="0a0db-205">名称</span><span class="sxs-lookup"><span data-stu-id="0a0db-205">Name</span></span>            | <span data-ttu-id="0a0db-206">类型</span><span class="sxs-lookup"><span data-stu-id="0a0db-206">Type</span></span>             | <span data-ttu-id="0a0db-207">必需</span><span class="sxs-lookup"><span data-stu-id="0a0db-207">Required</span></span> | <span data-ttu-id="0a0db-208">备注</span><span class="sxs-lookup"><span data-stu-id="0a0db-208">Notes</span></span>
--------------- | ---------------- | -------- | -----
<span data-ttu-id="0a0db-209">commitId</span><span class="sxs-lookup"><span data-stu-id="0a0db-209">commitId</span></span>        | <span data-ttu-id="0a0db-210">字符串</span><span class="sxs-lookup"><span data-stu-id="0a0db-210">string</span></span>           | <span data-ttu-id="0a0db-211">是</span><span class="sxs-lookup"><span data-stu-id="0a0db-211">yes</span></span>      | <span data-ttu-id="0a0db-212">与此页中的最新提交关联的唯一 ID</span><span class="sxs-lookup"><span data-stu-id="0a0db-212">A unique ID associated with the most recent commit in this page</span></span>
<span data-ttu-id="0a0db-213">commitTimeStamp</span><span class="sxs-lookup"><span data-stu-id="0a0db-213">commitTimeStamp</span></span> | <span data-ttu-id="0a0db-214">字符串</span><span class="sxs-lookup"><span data-stu-id="0a0db-214">string</span></span>           | <span data-ttu-id="0a0db-215">是</span><span class="sxs-lookup"><span data-stu-id="0a0db-215">yes</span></span>      | <span data-ttu-id="0a0db-216">此页中的最新提交的时间戳</span><span class="sxs-lookup"><span data-stu-id="0a0db-216">A timestamp of the most recent commit in this page</span></span>
<span data-ttu-id="0a0db-217">count</span><span class="sxs-lookup"><span data-stu-id="0a0db-217">count</span></span>           | <span data-ttu-id="0a0db-218">integer</span><span class="sxs-lookup"><span data-stu-id="0a0db-218">integer</span></span>          | <span data-ttu-id="0a0db-219">是</span><span class="sxs-lookup"><span data-stu-id="0a0db-219">yes</span></span>      | <span data-ttu-id="0a0db-220">页面中的项目数</span><span class="sxs-lookup"><span data-stu-id="0a0db-220">The number of items in the page</span></span>
<span data-ttu-id="0a0db-221">items</span><span class="sxs-lookup"><span data-stu-id="0a0db-221">items</span></span>           | <span data-ttu-id="0a0db-222">对象数组</span><span class="sxs-lookup"><span data-stu-id="0a0db-222">array of objects</span></span> | <span data-ttu-id="0a0db-223">是</span><span class="sxs-lookup"><span data-stu-id="0a0db-223">yes</span></span>      | <span data-ttu-id="0a0db-224">此页中的目录项</span><span class="sxs-lookup"><span data-stu-id="0a0db-224">The catalog items in this page</span></span>
<span data-ttu-id="0a0db-225">父级 (parent)</span><span class="sxs-lookup"><span data-stu-id="0a0db-225">parent</span></span>          | <span data-ttu-id="0a0db-226">字符串</span><span class="sxs-lookup"><span data-stu-id="0a0db-226">string</span></span>           | <span data-ttu-id="0a0db-227">是</span><span class="sxs-lookup"><span data-stu-id="0a0db-227">yes</span></span>      | <span data-ttu-id="0a0db-228">目录索引的 URL</span><span class="sxs-lookup"><span data-stu-id="0a0db-228">A URL to the catalog index</span></span>

<span data-ttu-id="0a0db-229">数组中的每个元素 `items` 都是一个对象，其中包含有关目录项的一些最少的详细信息。</span><span class="sxs-lookup"><span data-stu-id="0a0db-229">Each element in the `items` array is an object with some minimal details about the catalog item.</span></span> <span data-ttu-id="0a0db-230">这些项对象不包含目录项的所有数据。</span><span class="sxs-lookup"><span data-stu-id="0a0db-230">These item objects do not contain all of the catalog item's data.</span></span> <span data-ttu-id="0a0db-231">页的数组中项的顺序 `items` 未定义。</span><span class="sxs-lookup"><span data-stu-id="0a0db-231">The order of the items in the page's `items` array is not defined.</span></span> <span data-ttu-id="0a0db-232">客户端可以使用其属性在内存中对项进行排序 `commitTimeStamp` 。</span><span class="sxs-lookup"><span data-stu-id="0a0db-232">Items can be ordered by the client in memory using their `commitTimeStamp` property.</span></span>

<span data-ttu-id="0a0db-233">页中目录项的数目由服务器实现定义。</span><span class="sxs-lookup"><span data-stu-id="0a0db-233">The number of catalog items in a page is defined by server implementation.</span></span> <span data-ttu-id="0a0db-234">对于 nuget.org，每个页面中最多包含550个项目，但对于某些页面，实际数字可能较小，具体取决于下一个提交批处理的时间点大小。</span><span class="sxs-lookup"><span data-stu-id="0a0db-234">For nuget.org, there are at most 550 items in each page, although the actual number may be smaller for some pages depending on the size of the next commit batch at the point in time.</span></span>

<span data-ttu-id="0a0db-235">引入新项 `count` 后，会递增，新目录项对象会出现在数组中 `items` 。</span><span class="sxs-lookup"><span data-stu-id="0a0db-235">As new items are introduced, the `count` is incremented and new catalog item objects appear in the `items` array.</span></span>

<span data-ttu-id="0a0db-236">当向页面添加项时，所 `commitId` 做的更改和将 `commitTimeStamp` 增加。</span><span class="sxs-lookup"><span data-stu-id="0a0db-236">As items are added to the page, the `commitId` changes and the `commitTimeStamp` increases.</span></span> <span data-ttu-id="0a0db-237">这两个属性本质上是对 `commitId` 数组中所有和值的汇总 `commitTimeStamp` `items` 。</span><span class="sxs-lookup"><span data-stu-id="0a0db-237">These two properties are essentially a summary over all `commitId` and `commitTimeStamp` values in the `items` array.</span></span>

### <a name="catalog-item-object-in-a-page"></a><span data-ttu-id="0a0db-238">页面中的目录项对象</span><span class="sxs-lookup"><span data-stu-id="0a0db-238">Catalog item object in a page</span></span>

<span data-ttu-id="0a0db-239">在目录页的属性中找到的目录项对象 `items` 具有以下属性：</span><span class="sxs-lookup"><span data-stu-id="0a0db-239">The catalog item objects found in the catalog page's `items` property have the following properties:</span></span>

<span data-ttu-id="0a0db-240">名称</span><span class="sxs-lookup"><span data-stu-id="0a0db-240">Name</span></span>            | <span data-ttu-id="0a0db-241">类型</span><span class="sxs-lookup"><span data-stu-id="0a0db-241">Type</span></span>    | <span data-ttu-id="0a0db-242">必需</span><span class="sxs-lookup"><span data-stu-id="0a0db-242">Required</span></span> | <span data-ttu-id="0a0db-243">备注</span><span class="sxs-lookup"><span data-stu-id="0a0db-243">Notes</span></span>
--------------- | ------- | -------- | -----
@id             | <span data-ttu-id="0a0db-244">字符串</span><span class="sxs-lookup"><span data-stu-id="0a0db-244">string</span></span>  | <span data-ttu-id="0a0db-245">是</span><span class="sxs-lookup"><span data-stu-id="0a0db-245">yes</span></span>      | <span data-ttu-id="0a0db-246">要提取目录项的 URL</span><span class="sxs-lookup"><span data-stu-id="0a0db-246">The URL to fetch the catalog item</span></span>
@type           | <span data-ttu-id="0a0db-247">字符串</span><span class="sxs-lookup"><span data-stu-id="0a0db-247">string</span></span>  | <span data-ttu-id="0a0db-248">是</span><span class="sxs-lookup"><span data-stu-id="0a0db-248">yes</span></span>      | <span data-ttu-id="0a0db-249">目录项的类型</span><span class="sxs-lookup"><span data-stu-id="0a0db-249">The type of the catalog item</span></span>
<span data-ttu-id="0a0db-250">commitId</span><span class="sxs-lookup"><span data-stu-id="0a0db-250">commitId</span></span>        | <span data-ttu-id="0a0db-251">字符串</span><span class="sxs-lookup"><span data-stu-id="0a0db-251">string</span></span>  | <span data-ttu-id="0a0db-252">是</span><span class="sxs-lookup"><span data-stu-id="0a0db-252">yes</span></span>      | <span data-ttu-id="0a0db-253">与此目录项关联的提交 ID</span><span class="sxs-lookup"><span data-stu-id="0a0db-253">The commit ID associated with this catalog item</span></span>
<span data-ttu-id="0a0db-254">commitTimeStamp</span><span class="sxs-lookup"><span data-stu-id="0a0db-254">commitTimeStamp</span></span> | <span data-ttu-id="0a0db-255">字符串</span><span class="sxs-lookup"><span data-stu-id="0a0db-255">string</span></span>  | <span data-ttu-id="0a0db-256">是</span><span class="sxs-lookup"><span data-stu-id="0a0db-256">yes</span></span>      | <span data-ttu-id="0a0db-257">此目录项的提交时间戳</span><span class="sxs-lookup"><span data-stu-id="0a0db-257">The commit timestamp of this catalog item</span></span>
<span data-ttu-id="0a0db-258">nuget： id</span><span class="sxs-lookup"><span data-stu-id="0a0db-258">nuget:id</span></span>        | <span data-ttu-id="0a0db-259">字符串</span><span class="sxs-lookup"><span data-stu-id="0a0db-259">string</span></span>  | <span data-ttu-id="0a0db-260">是</span><span class="sxs-lookup"><span data-stu-id="0a0db-260">yes</span></span>      | <span data-ttu-id="0a0db-261">此叶相关的包 ID</span><span class="sxs-lookup"><span data-stu-id="0a0db-261">The package ID that this leaf is related to</span></span>
<span data-ttu-id="0a0db-262">nuget：版本</span><span class="sxs-lookup"><span data-stu-id="0a0db-262">nuget:version</span></span>   | <span data-ttu-id="0a0db-263">字符串</span><span class="sxs-lookup"><span data-stu-id="0a0db-263">string</span></span>  | <span data-ttu-id="0a0db-264">是</span><span class="sxs-lookup"><span data-stu-id="0a0db-264">yes</span></span>      | <span data-ttu-id="0a0db-265">此叶相关的包版本</span><span class="sxs-lookup"><span data-stu-id="0a0db-265">The package version that this leaf is related to</span></span>

<span data-ttu-id="0a0db-266">`@type`该值将是以下两个值之一：</span><span class="sxs-lookup"><span data-stu-id="0a0db-266">The `@type` value will be one of the following two values:</span></span>

1. <span data-ttu-id="0a0db-267">`nuget:PackageDetails`：对应于 `PackageDetails` 目录叶文档中的类型。</span><span class="sxs-lookup"><span data-stu-id="0a0db-267">`nuget:PackageDetails`: this corresponds to `PackageDetails` type in the catalog leaf document.</span></span>
1. <span data-ttu-id="0a0db-268">`nuget:PackageDelete`：对应于 `PackageDelete` 目录叶文档中的类型。</span><span class="sxs-lookup"><span data-stu-id="0a0db-268">`nuget:PackageDelete`: this corresponds to the `PackageDelete` type in the catalog leaf document.</span></span>

<span data-ttu-id="0a0db-269">有关每种类型含义的更多详细信息，请参阅下面的[相应项类型](#item-types)。</span><span class="sxs-lookup"><span data-stu-id="0a0db-269">For more details about what each type means, see the [corresponding items type](#item-types) below.</span></span>

### <a name="sample-request"></a><span data-ttu-id="0a0db-270">示例请求</span><span class="sxs-lookup"><span data-stu-id="0a0db-270">Sample request</span></span>

    GET https://api.nuget.org/v3/catalog0/page2926.json

### <a name="sample-response"></a><span data-ttu-id="0a0db-271">示例响应</span><span class="sxs-lookup"><span data-stu-id="0a0db-271">Sample response</span></span>

[!code-JSON [catalog-page.json](./_data/catalog-page.json)]

## <a name="catalog-leaf"></a><span data-ttu-id="0a0db-272">目录叶</span><span class="sxs-lookup"><span data-stu-id="0a0db-272">Catalog leaf</span></span>

<span data-ttu-id="0a0db-273">目录叶包含某些时间点特定包 ID 和版本的相关元数据。</span><span class="sxs-lookup"><span data-stu-id="0a0db-273">The catalog leaf contains metadata about a specific package ID and version at some point in time.</span></span> <span data-ttu-id="0a0db-274">它是使用 `@id` 目录页中的值提取的文档。</span><span class="sxs-lookup"><span data-stu-id="0a0db-274">It is a document fetched using the `@id` value found in a catalog page.</span></span> <span data-ttu-id="0a0db-275">目录叶的 URL 不应是可预测的，应仅使用目录页来发现。</span><span class="sxs-lookup"><span data-stu-id="0a0db-275">The URL to a catalog leaf is not intended to be predictable and should be discovered using only a catalog page.</span></span>

<span data-ttu-id="0a0db-276">目录叶文档是包含以下属性的 JSON 对象：</span><span class="sxs-lookup"><span data-stu-id="0a0db-276">The catalog leaf document is a JSON object with the following properties:</span></span>

<span data-ttu-id="0a0db-277">名称</span><span class="sxs-lookup"><span data-stu-id="0a0db-277">Name</span></span>                    | <span data-ttu-id="0a0db-278">类型</span><span class="sxs-lookup"><span data-stu-id="0a0db-278">Type</span></span>                       | <span data-ttu-id="0a0db-279">必需</span><span class="sxs-lookup"><span data-stu-id="0a0db-279">Required</span></span> | <span data-ttu-id="0a0db-280">备注</span><span class="sxs-lookup"><span data-stu-id="0a0db-280">Notes</span></span>
----------------------- | -------------------------- | -------- | -----
@type                   | <span data-ttu-id="0a0db-281">字符串或字符串数组</span><span class="sxs-lookup"><span data-stu-id="0a0db-281">string or array of strings</span></span> | <span data-ttu-id="0a0db-282">是</span><span class="sxs-lookup"><span data-stu-id="0a0db-282">yes</span></span>      | <span data-ttu-id="0a0db-283">目录项的类型</span><span class="sxs-lookup"><span data-stu-id="0a0db-283">The type(s) of the catalog item</span></span>
<span data-ttu-id="0a0db-284">目录： commitId</span><span class="sxs-lookup"><span data-stu-id="0a0db-284">catalog:commitId</span></span>        | <span data-ttu-id="0a0db-285">字符串</span><span class="sxs-lookup"><span data-stu-id="0a0db-285">string</span></span>                     | <span data-ttu-id="0a0db-286">是</span><span class="sxs-lookup"><span data-stu-id="0a0db-286">yes</span></span>      | <span data-ttu-id="0a0db-287">与此目录项关联的提交 ID</span><span class="sxs-lookup"><span data-stu-id="0a0db-287">A commit ID associated with this catalog item</span></span>
<span data-ttu-id="0a0db-288">目录： commitTimeStamp</span><span class="sxs-lookup"><span data-stu-id="0a0db-288">catalog:commitTimeStamp</span></span> | <span data-ttu-id="0a0db-289">字符串</span><span class="sxs-lookup"><span data-stu-id="0a0db-289">string</span></span>                     | <span data-ttu-id="0a0db-290">是</span><span class="sxs-lookup"><span data-stu-id="0a0db-290">yes</span></span>      | <span data-ttu-id="0a0db-291">此目录项的提交时间戳</span><span class="sxs-lookup"><span data-stu-id="0a0db-291">The commit timestamp of this catalog item</span></span>
<span data-ttu-id="0a0db-292">id</span><span class="sxs-lookup"><span data-stu-id="0a0db-292">id</span></span>                      | <span data-ttu-id="0a0db-293">字符串</span><span class="sxs-lookup"><span data-stu-id="0a0db-293">string</span></span>                     | <span data-ttu-id="0a0db-294">是</span><span class="sxs-lookup"><span data-stu-id="0a0db-294">yes</span></span>      | <span data-ttu-id="0a0db-295">目录项的包 ID</span><span class="sxs-lookup"><span data-stu-id="0a0db-295">The package ID of the catalog item</span></span>
<span data-ttu-id="0a0db-296">published</span><span class="sxs-lookup"><span data-stu-id="0a0db-296">published</span></span>               | <span data-ttu-id="0a0db-297">字符串</span><span class="sxs-lookup"><span data-stu-id="0a0db-297">string</span></span>                     | <span data-ttu-id="0a0db-298">是</span><span class="sxs-lookup"><span data-stu-id="0a0db-298">yes</span></span>      | <span data-ttu-id="0a0db-299">包目录项的发布日期</span><span class="sxs-lookup"><span data-stu-id="0a0db-299">The published date of the package catalog item</span></span>
<span data-ttu-id="0a0db-300">版本</span><span class="sxs-lookup"><span data-stu-id="0a0db-300">version</span></span>                 | <span data-ttu-id="0a0db-301">字符串</span><span class="sxs-lookup"><span data-stu-id="0a0db-301">string</span></span>                     | <span data-ttu-id="0a0db-302">是</span><span class="sxs-lookup"><span data-stu-id="0a0db-302">yes</span></span>      | <span data-ttu-id="0a0db-303">目录项的包版本</span><span class="sxs-lookup"><span data-stu-id="0a0db-303">The package version of the catalog item</span></span>

### <a name="item-types"></a><span data-ttu-id="0a0db-304">项类型</span><span class="sxs-lookup"><span data-stu-id="0a0db-304">Item types</span></span>

<span data-ttu-id="0a0db-305">`@type`属性是字符串或字符串数组。</span><span class="sxs-lookup"><span data-stu-id="0a0db-305">The `@type` property is a string or array of strings.</span></span> <span data-ttu-id="0a0db-306">为方便起见，如果 `@type` 值为字符串，则应将其视为大小为1的任意数组。</span><span class="sxs-lookup"><span data-stu-id="0a0db-306">For convenience, if the `@type` value is a string, it should be treated as any array of size one.</span></span> <span data-ttu-id="0a0db-307">并非的所有可能值 `@type` 都有记录。</span><span class="sxs-lookup"><span data-stu-id="0a0db-307">Not all possible values for `@type` are documented.</span></span> <span data-ttu-id="0a0db-308">但是，每个目录项都有以下两个字符串类型值中的一个：</span><span class="sxs-lookup"><span data-stu-id="0a0db-308">However, each catalog item has exactly one of the two following string type values:</span></span>

1. <span data-ttu-id="0a0db-309">`PackageDetails`：表示包元数据的快照</span><span class="sxs-lookup"><span data-stu-id="0a0db-309">`PackageDetails`: represents a snapshot of package metadata</span></span>
1. <span data-ttu-id="0a0db-310">`PackageDelete`：表示已删除的包</span><span class="sxs-lookup"><span data-stu-id="0a0db-310">`PackageDelete`: represents a package that was deleted</span></span>

### <a name="package-details-catalog-items"></a><span data-ttu-id="0a0db-311">包详细信息目录项</span><span class="sxs-lookup"><span data-stu-id="0a0db-311">Package details catalog items</span></span>

<span data-ttu-id="0a0db-312">类型为的目录项 `PackageDetails` 包含特定包的包元数据（ID 和版本组合）的快照。</span><span class="sxs-lookup"><span data-stu-id="0a0db-312">Catalog items with the type `PackageDetails` contain a snapshot of package metadata for a specific package (ID and version combination).</span></span> <span data-ttu-id="0a0db-313">包源遇到以下任何情况时，将生成包详细信息目录项：</span><span class="sxs-lookup"><span data-stu-id="0a0db-313">A package details catalog item is produced when a package source encounters any of the following scenarios:</span></span>

1. <span data-ttu-id="0a0db-314">**推送**包。</span><span class="sxs-lookup"><span data-stu-id="0a0db-314">A package is **pushed**.</span></span>
1. <span data-ttu-id="0a0db-315">已**列出**包。</span><span class="sxs-lookup"><span data-stu-id="0a0db-315">A package is **listed**.</span></span>
1. <span data-ttu-id="0a0db-316">未**列出**包。</span><span class="sxs-lookup"><span data-stu-id="0a0db-316">A package is **unlisted**.</span></span>
1. <span data-ttu-id="0a0db-317">包为**重排**。</span><span class="sxs-lookup"><span data-stu-id="0a0db-317">A package is **reflowed**.</span></span>

<span data-ttu-id="0a0db-318">包重排是一种管理手势，它实质上生成了现有包的虚设推送，无对包本身的任何更改。</span><span class="sxs-lookup"><span data-stu-id="0a0db-318">A package reflow is an administrative gesture that essentially generates a fake push of an existing package with no changes to the package itself.</span></span> <span data-ttu-id="0a0db-319">在 nuget.org 上，在使用目录的后台作业之一中修复 bug 后，将使用重排。</span><span class="sxs-lookup"><span data-stu-id="0a0db-319">On nuget.org, a reflow is used after fixing a bug in one of the background jobs which consume the catalog.</span></span>

<span data-ttu-id="0a0db-320">使用目录项的客户端不应尝试确定哪些方案生成了目录项。</span><span class="sxs-lookup"><span data-stu-id="0a0db-320">Clients consuming the catalog items should not attempt to determine which of these scenarios produced the catalog item.</span></span> <span data-ttu-id="0a0db-321">相反，客户端只需用目录项中包含的元数据更新任何已维护的视图或索引。</span><span class="sxs-lookup"><span data-stu-id="0a0db-321">Instead, the client should simply update any maintained view or index with the metadata contained in the catalog item.</span></span> <span data-ttu-id="0a0db-322">此外，应妥善处理重复或冗余的目录项目（幂等方式）。</span><span class="sxs-lookup"><span data-stu-id="0a0db-322">Furthermore, duplicate or redundant catalog items should be handled gracefully (idempotently).</span></span>

<span data-ttu-id="0a0db-323">包详细信息目录项除[包含在所有目录叶上](#catalog-leaf)的属性外，还具有以下属性。</span><span class="sxs-lookup"><span data-stu-id="0a0db-323">Package details catalog items have the following properties in addition to those [included on all catalog leaves](#catalog-leaf).</span></span>

<span data-ttu-id="0a0db-324">名称</span><span class="sxs-lookup"><span data-stu-id="0a0db-324">Name</span></span>                    | <span data-ttu-id="0a0db-325">类型</span><span class="sxs-lookup"><span data-stu-id="0a0db-325">Type</span></span>                       | <span data-ttu-id="0a0db-326">必需</span><span class="sxs-lookup"><span data-stu-id="0a0db-326">Required</span></span> | <span data-ttu-id="0a0db-327">备注</span><span class="sxs-lookup"><span data-stu-id="0a0db-327">Notes</span></span>
----------------------- | -------------------------- | -------- | -----
<span data-ttu-id="0a0db-328">作者</span><span class="sxs-lookup"><span data-stu-id="0a0db-328">authors</span></span>                 | <span data-ttu-id="0a0db-329">字符串</span><span class="sxs-lookup"><span data-stu-id="0a0db-329">string</span></span>                     | <span data-ttu-id="0a0db-330">否</span><span class="sxs-lookup"><span data-stu-id="0a0db-330">no</span></span>       |
<span data-ttu-id="0a0db-331">created</span><span class="sxs-lookup"><span data-stu-id="0a0db-331">created</span></span>                 | <span data-ttu-id="0a0db-332">字符串</span><span class="sxs-lookup"><span data-stu-id="0a0db-332">string</span></span>                     | <span data-ttu-id="0a0db-333">否</span><span class="sxs-lookup"><span data-stu-id="0a0db-333">no</span></span>       | <span data-ttu-id="0a0db-334">首次创建包时的时间戳。</span><span class="sxs-lookup"><span data-stu-id="0a0db-334">A timestamp of when the package was first created.</span></span> <span data-ttu-id="0a0db-335">回退属性： `published` 。</span><span class="sxs-lookup"><span data-stu-id="0a0db-335">Fallback property: `published`.</span></span>
<span data-ttu-id="0a0db-336">dependencyGroups</span><span class="sxs-lookup"><span data-stu-id="0a0db-336">dependencyGroups</span></span>        | <span data-ttu-id="0a0db-337">对象数组</span><span class="sxs-lookup"><span data-stu-id="0a0db-337">array of objects</span></span>           | <span data-ttu-id="0a0db-338">否</span><span class="sxs-lookup"><span data-stu-id="0a0db-338">no</span></span>       | <span data-ttu-id="0a0db-339">包的依赖项，按目标框架分组（与[包元数据资源的格式相同](registration-base-url-resource.md#package-dependency-group)）</span><span class="sxs-lookup"><span data-stu-id="0a0db-339">The dependencies of the package, grouped by target framework ([same format as the package metadata resource](registration-base-url-resource.md#package-dependency-group))</span></span>
<span data-ttu-id="0a0db-340">弃用</span><span class="sxs-lookup"><span data-stu-id="0a0db-340">deprecation</span></span>             | <span data-ttu-id="0a0db-341">对象 (object)</span><span class="sxs-lookup"><span data-stu-id="0a0db-341">object</span></span>                     | <span data-ttu-id="0a0db-342">否</span><span class="sxs-lookup"><span data-stu-id="0a0db-342">no</span></span>       | <span data-ttu-id="0a0db-343">与包关联的弃用（与[包元数据资源的格式相同](registration-base-url-resource.md#package-deprecation)）</span><span class="sxs-lookup"><span data-stu-id="0a0db-343">The deprecation associated with the package ([same format as the package metadata resource](registration-base-url-resource.md#package-deprecation))</span></span>
<span data-ttu-id="0a0db-344">description</span><span class="sxs-lookup"><span data-stu-id="0a0db-344">description</span></span>             | <span data-ttu-id="0a0db-345">字符串</span><span class="sxs-lookup"><span data-stu-id="0a0db-345">string</span></span>                     | <span data-ttu-id="0a0db-346">否</span><span class="sxs-lookup"><span data-stu-id="0a0db-346">no</span></span>       |
<span data-ttu-id="0a0db-347">iconUrl</span><span class="sxs-lookup"><span data-stu-id="0a0db-347">iconUrl</span></span>                 | <span data-ttu-id="0a0db-348">字符串</span><span class="sxs-lookup"><span data-stu-id="0a0db-348">string</span></span>                     | <span data-ttu-id="0a0db-349">否</span><span class="sxs-lookup"><span data-stu-id="0a0db-349">no</span></span>       |
<span data-ttu-id="0a0db-350">isPrerelease</span><span class="sxs-lookup"><span data-stu-id="0a0db-350">isPrerelease</span></span>            | <span data-ttu-id="0a0db-351">boolean</span><span class="sxs-lookup"><span data-stu-id="0a0db-351">boolean</span></span>                    | <span data-ttu-id="0a0db-352">否</span><span class="sxs-lookup"><span data-stu-id="0a0db-352">no</span></span>       | <span data-ttu-id="0a0db-353">包版本是否为预发布版本。</span><span class="sxs-lookup"><span data-stu-id="0a0db-353">Whether or not the package version is prerelease.</span></span> <span data-ttu-id="0a0db-354">可以从中检测到 `version` 。</span><span class="sxs-lookup"><span data-stu-id="0a0db-354">Can be detected from `version`.</span></span>
<span data-ttu-id="0a0db-355">语言</span><span class="sxs-lookup"><span data-stu-id="0a0db-355">language</span></span>                | <span data-ttu-id="0a0db-356">字符串</span><span class="sxs-lookup"><span data-stu-id="0a0db-356">string</span></span>                     | <span data-ttu-id="0a0db-357">否</span><span class="sxs-lookup"><span data-stu-id="0a0db-357">no</span></span>       |
<span data-ttu-id="0a0db-358">licenseUrl</span><span class="sxs-lookup"><span data-stu-id="0a0db-358">licenseUrl</span></span>              | <span data-ttu-id="0a0db-359">字符串</span><span class="sxs-lookup"><span data-stu-id="0a0db-359">string</span></span>                     | <span data-ttu-id="0a0db-360">否</span><span class="sxs-lookup"><span data-stu-id="0a0db-360">no</span></span>       |
<span data-ttu-id="0a0db-361">列出</span><span class="sxs-lookup"><span data-stu-id="0a0db-361">listed</span></span>                  | <span data-ttu-id="0a0db-362">boolean</span><span class="sxs-lookup"><span data-stu-id="0a0db-362">boolean</span></span>                    | <span data-ttu-id="0a0db-363">否</span><span class="sxs-lookup"><span data-stu-id="0a0db-363">no</span></span>       | <span data-ttu-id="0a0db-364">是否列出包</span><span class="sxs-lookup"><span data-stu-id="0a0db-364">Whether or not the package is listed</span></span>
<span data-ttu-id="0a0db-365">minClientVersion</span><span class="sxs-lookup"><span data-stu-id="0a0db-365">minClientVersion</span></span>        | <span data-ttu-id="0a0db-366">字符串</span><span class="sxs-lookup"><span data-stu-id="0a0db-366">string</span></span>                     | <span data-ttu-id="0a0db-367">否</span><span class="sxs-lookup"><span data-stu-id="0a0db-367">no</span></span>       |
<span data-ttu-id="0a0db-368">packageHash</span><span class="sxs-lookup"><span data-stu-id="0a0db-368">packageHash</span></span>             | <span data-ttu-id="0a0db-369">字符串</span><span class="sxs-lookup"><span data-stu-id="0a0db-369">string</span></span>                     | <span data-ttu-id="0a0db-370">是</span><span class="sxs-lookup"><span data-stu-id="0a0db-370">yes</span></span>      | <span data-ttu-id="0a0db-371">包哈希，使用[标准基 64](https://tools.ietf.org/html/rfc4648#section-4)编码</span><span class="sxs-lookup"><span data-stu-id="0a0db-371">The hash of the package, encoding using [standard base 64](https://tools.ietf.org/html/rfc4648#section-4)</span></span>
<span data-ttu-id="0a0db-372">packageHashAlgorithm</span><span class="sxs-lookup"><span data-stu-id="0a0db-372">packageHashAlgorithm</span></span>    | <span data-ttu-id="0a0db-373">字符串</span><span class="sxs-lookup"><span data-stu-id="0a0db-373">string</span></span>                     | <span data-ttu-id="0a0db-374">是</span><span class="sxs-lookup"><span data-stu-id="0a0db-374">yes</span></span>      |
<span data-ttu-id="0a0db-375">packageSize</span><span class="sxs-lookup"><span data-stu-id="0a0db-375">packageSize</span></span>             | <span data-ttu-id="0a0db-376">integer</span><span class="sxs-lookup"><span data-stu-id="0a0db-376">integer</span></span>                    | <span data-ttu-id="0a0db-377">是</span><span class="sxs-lookup"><span data-stu-id="0a0db-377">yes</span></span>      | <span data-ttu-id="0a0db-378">包的大小（以字节为单位） nupkg</span><span class="sxs-lookup"><span data-stu-id="0a0db-378">The size of the package .nupkg in bytes</span></span>
<span data-ttu-id="0a0db-379">packageTypes</span><span class="sxs-lookup"><span data-stu-id="0a0db-379">packageTypes</span></span>            | <span data-ttu-id="0a0db-380">对象数组</span><span class="sxs-lookup"><span data-stu-id="0a0db-380">array of objects</span></span>           | <span data-ttu-id="0a0db-381">否</span><span class="sxs-lookup"><span data-stu-id="0a0db-381">no</span></span>       | <span data-ttu-id="0a0db-382">作者指定的包类型。</span><span class="sxs-lookup"><span data-stu-id="0a0db-382">The package types specified by the author.</span></span>
<span data-ttu-id="0a0db-383">projectUrl</span><span class="sxs-lookup"><span data-stu-id="0a0db-383">projectUrl</span></span>              | <span data-ttu-id="0a0db-384">字符串</span><span class="sxs-lookup"><span data-stu-id="0a0db-384">string</span></span>                     | <span data-ttu-id="0a0db-385">否</span><span class="sxs-lookup"><span data-stu-id="0a0db-385">no</span></span>       |
<span data-ttu-id="0a0db-386">releaseNotes</span><span class="sxs-lookup"><span data-stu-id="0a0db-386">releaseNotes</span></span>            | <span data-ttu-id="0a0db-387">字符串</span><span class="sxs-lookup"><span data-stu-id="0a0db-387">string</span></span>                     | <span data-ttu-id="0a0db-388">否</span><span class="sxs-lookup"><span data-stu-id="0a0db-388">no</span></span>       |
<span data-ttu-id="0a0db-389">requireLicenseAgreement</span><span class="sxs-lookup"><span data-stu-id="0a0db-389">requireLicenseAgreement</span></span> | <span data-ttu-id="0a0db-390">boolean</span><span class="sxs-lookup"><span data-stu-id="0a0db-390">boolean</span></span>                    | <span data-ttu-id="0a0db-391">否</span><span class="sxs-lookup"><span data-stu-id="0a0db-391">no</span></span>       | <span data-ttu-id="0a0db-392">假设 `false` 排除</span><span class="sxs-lookup"><span data-stu-id="0a0db-392">Assume `false` if excluded</span></span>
<span data-ttu-id="0a0db-393">摘要</span><span class="sxs-lookup"><span data-stu-id="0a0db-393">summary</span></span>                 | <span data-ttu-id="0a0db-394">字符串</span><span class="sxs-lookup"><span data-stu-id="0a0db-394">string</span></span>                     | <span data-ttu-id="0a0db-395">否</span><span class="sxs-lookup"><span data-stu-id="0a0db-395">no</span></span>       |
<span data-ttu-id="0a0db-396">tags</span><span class="sxs-lookup"><span data-stu-id="0a0db-396">tags</span></span>                    | <span data-ttu-id="0a0db-397">字符串数组</span><span class="sxs-lookup"><span data-stu-id="0a0db-397">array of strings</span></span>           | <span data-ttu-id="0a0db-398">否</span><span class="sxs-lookup"><span data-stu-id="0a0db-398">no</span></span>       |
<span data-ttu-id="0a0db-399">title</span><span class="sxs-lookup"><span data-stu-id="0a0db-399">title</span></span>                   | <span data-ttu-id="0a0db-400">字符串</span><span class="sxs-lookup"><span data-stu-id="0a0db-400">string</span></span>                     | <span data-ttu-id="0a0db-401">否</span><span class="sxs-lookup"><span data-stu-id="0a0db-401">no</span></span>       |
<span data-ttu-id="0a0db-402">verbatimVersion</span><span class="sxs-lookup"><span data-stu-id="0a0db-402">verbatimVersion</span></span>         | <span data-ttu-id="0a0db-403">字符串</span><span class="sxs-lookup"><span data-stu-id="0a0db-403">string</span></span>                     | <span data-ttu-id="0a0db-404">否</span><span class="sxs-lookup"><span data-stu-id="0a0db-404">no</span></span>       | <span data-ttu-id="0a0db-405">最初在中找到的版本字符串。 nuspec</span><span class="sxs-lookup"><span data-stu-id="0a0db-405">The version string as it's originally found in the .nuspec</span></span>

<span data-ttu-id="0a0db-406">Package `version` 属性是规范化后的完整版本字符串。</span><span class="sxs-lookup"><span data-stu-id="0a0db-406">The package `version` property is the full version string after normalization.</span></span> <span data-ttu-id="0a0db-407">这意味着，可以在此处包括 SemVer 2.0.0 生成数据。</span><span class="sxs-lookup"><span data-stu-id="0a0db-407">This means that SemVer 2.0.0 build data can be included here.</span></span>

<span data-ttu-id="0a0db-408">`created`时间戳是包源首次接收包时的时间戳，通常是目录项的提交时间戳之前的短暂时间。</span><span class="sxs-lookup"><span data-stu-id="0a0db-408">The `created` timestamp is when the package was first received by the package source, which is typically a short time before the catalog item's commit timestamp.</span></span>

<span data-ttu-id="0a0db-409">`packageHashAlgorithm`是一个由服务器实现定义的字符串，该字符串表示用于生成的哈希算法 `packageHash` 。</span><span class="sxs-lookup"><span data-stu-id="0a0db-409">The `packageHashAlgorithm` is a string defined by the server implementation representing the hashing algorithm used to produce the `packageHash`.</span></span> <span data-ttu-id="0a0db-410">nuget.org 始终使用的 `packageHashAlgorithm` 值 `SHA512` 。</span><span class="sxs-lookup"><span data-stu-id="0a0db-410">nuget.org always used the `packageHashAlgorithm` value of `SHA512`.</span></span>

<span data-ttu-id="0a0db-411">`packageTypes`仅当作者指定了包类型时，才会显示该属性。</span><span class="sxs-lookup"><span data-stu-id="0a0db-411">The `packageTypes` property will only be present if a package type was specified by the author.</span></span> <span data-ttu-id="0a0db-412">如果存在，它将始终至少具有一个（1）条目。</span><span class="sxs-lookup"><span data-stu-id="0a0db-412">If it is present, it will always have at least one (1) entry.</span></span> <span data-ttu-id="0a0db-413">数组中的每一项 `packageTypes` 都是具有以下属性的 JSON 对象：</span><span class="sxs-lookup"><span data-stu-id="0a0db-413">Each item in the `packageTypes` array is a JSON object with the following properties:</span></span>

<span data-ttu-id="0a0db-414">名称</span><span class="sxs-lookup"><span data-stu-id="0a0db-414">Name</span></span>      | <span data-ttu-id="0a0db-415">类型</span><span class="sxs-lookup"><span data-stu-id="0a0db-415">Type</span></span>    | <span data-ttu-id="0a0db-416">必需</span><span class="sxs-lookup"><span data-stu-id="0a0db-416">Required</span></span> | <span data-ttu-id="0a0db-417">说明</span><span class="sxs-lookup"><span data-stu-id="0a0db-417">Notes</span></span>
--------- | ------- | -------- | -----
<span data-ttu-id="0a0db-418">name</span><span class="sxs-lookup"><span data-stu-id="0a0db-418">name</span></span>      | <span data-ttu-id="0a0db-419">字符串</span><span class="sxs-lookup"><span data-stu-id="0a0db-419">string</span></span>  | <span data-ttu-id="0a0db-420">是</span><span class="sxs-lookup"><span data-stu-id="0a0db-420">yes</span></span>      | <span data-ttu-id="0a0db-421">包类型的名称。</span><span class="sxs-lookup"><span data-stu-id="0a0db-421">The name of the package type.</span></span>
<span data-ttu-id="0a0db-422">版本</span><span class="sxs-lookup"><span data-stu-id="0a0db-422">version</span></span>    | <span data-ttu-id="0a0db-423">字符串</span><span class="sxs-lookup"><span data-stu-id="0a0db-423">string</span></span>  | <span data-ttu-id="0a0db-424">否</span><span class="sxs-lookup"><span data-stu-id="0a0db-424">no</span></span>       | <span data-ttu-id="0a0db-425">包类型的版本。</span><span class="sxs-lookup"><span data-stu-id="0a0db-425">The version of the package type.</span></span> <span data-ttu-id="0a0db-426">只有在作者显式指定了 nuspec 中的版本时，才会出现此情况。</span><span class="sxs-lookup"><span data-stu-id="0a0db-426">Only present if the author explicitly specified a version in the nuspec.</span></span>

<span data-ttu-id="0a0db-427">`published`时间戳是上次列出包的时间。</span><span class="sxs-lookup"><span data-stu-id="0a0db-427">The `published` timestamp is the time when the package was last listed.</span></span>

> [!Note]
> <span data-ttu-id="0a0db-428">在 nuget.org 上， `published` 当包未列出时，该值将设置为1900年。</span><span class="sxs-lookup"><span data-stu-id="0a0db-428">On nuget.org, the `published` value is set to the year 1900 when the package is unlisted.</span></span>

#### <a name="sample-request"></a><span data-ttu-id="0a0db-429">示例请求</span><span class="sxs-lookup"><span data-stu-id="0a0db-429">Sample request</span></span>

<span data-ttu-id="0a0db-430">GET https://api.nuget.org/v3/catalog0/data/2015.02.01.11.18.40/windowsazure.storage.1.0.0.json</span><span class="sxs-lookup"><span data-stu-id="0a0db-430">GET https://api.nuget.org/v3/catalog0/data/2015.02.01.11.18.40/windowsazure.storage.1.0.0.json</span></span>

#### <a name="sample-response"></a><span data-ttu-id="0a0db-431">示例响应</span><span class="sxs-lookup"><span data-stu-id="0a0db-431">Sample response</span></span>

[!code-JSON [catalog-package-details.json](./_data/catalog-package-details.json)]

### <a name="package-delete-catalog-items"></a><span data-ttu-id="0a0db-432">包删除目录项</span><span class="sxs-lookup"><span data-stu-id="0a0db-432">Package delete catalog items</span></span>

<span data-ttu-id="0a0db-433">类型为的目录项 `PackageDelete` 包含一组最小的信息，用于对客户端进行分类，指出包已从包源中删除并且不再可用于任何包操作（如还原）。</span><span class="sxs-lookup"><span data-stu-id="0a0db-433">Catalog items with the type `PackageDelete` contain a minimal set of information indicating to catalog clients that a package has been deleted from the package source and is no longer available for any package operation (such as restore).</span></span>

> [!NOTE]
> <span data-ttu-id="0a0db-434">包可能会被删除，以后使用相同的包 ID 和版本重新发布。</span><span class="sxs-lookup"><span data-stu-id="0a0db-434">It is possible for a package to be deleted and later republished using the same package ID and version.</span></span> <span data-ttu-id="0a0db-435">在 nuget.org 上，这种情况非常罕见，因为它打破了某个包 ID 和版本表示特定包内容的正式客户端假设。</span><span class="sxs-lookup"><span data-stu-id="0a0db-435">On nuget.org, this is a very rare case as it breaks the official client's assumption that a package ID and version imply a specific package content.</span></span> <span data-ttu-id="0a0db-436">有关 nuget.org 上的包删除的详细信息，请参阅[策略](../nuget-org/policies/deleting-packages.md)。</span><span class="sxs-lookup"><span data-stu-id="0a0db-436">For more information about package deletion on nuget.org, see [our policy](../nuget-org/policies/deleting-packages.md).</span></span>

<span data-ttu-id="0a0db-437">除了[所有目录叶上包含](#catalog-leaf)的属性外，包删除目录项还没有其他属性。</span><span class="sxs-lookup"><span data-stu-id="0a0db-437">Package delete catalog items have no additional properties in addition to those [included on all catalog leaves](#catalog-leaf).</span></span>

<span data-ttu-id="0a0db-438">`version`属性是在 nuspec 中找到的原始版本字符串。</span><span class="sxs-lookup"><span data-stu-id="0a0db-438">The `version` property is the original version string found in the package .nuspec.</span></span>

<span data-ttu-id="0a0db-439">`published`属性是删除包的时间，通常是目录项的提交时间戳之前的短暂时间。</span><span class="sxs-lookup"><span data-stu-id="0a0db-439">The `published` property is the time when package was deleted, which is typically as short time before the catalog item's commit timestamp.</span></span>

#### <a name="sample-request"></a><span data-ttu-id="0a0db-440">示例请求</span><span class="sxs-lookup"><span data-stu-id="0a0db-440">Sample request</span></span>

<span data-ttu-id="0a0db-441">GET https://api.nuget.org/v3/catalog0/data/2017.11.02.00.40.00/netstandard1.4_lib.1.0.0-test.json</span><span class="sxs-lookup"><span data-stu-id="0a0db-441">GET https://api.nuget.org/v3/catalog0/data/2017.11.02.00.40.00/netstandard1.4_lib.1.0.0-test.json</span></span>

#### <a name="sample-response"></a><span data-ttu-id="0a0db-442">示例响应</span><span class="sxs-lookup"><span data-stu-id="0a0db-442">Sample response</span></span>

[!code-JSON [catalog-package-delete.json](./_data/catalog-package-delete.json)]

## <a name="cursor"></a><span data-ttu-id="0a0db-443">游标</span><span class="sxs-lookup"><span data-stu-id="0a0db-443">Cursor</span></span>

### <a name="overview"></a><span data-ttu-id="0a0db-444">概述</span><span class="sxs-lookup"><span data-stu-id="0a0db-444">Overview</span></span>

<span data-ttu-id="0a0db-445">本部分介绍了尽管协议不一定是由协议强制的客户端概念，但它应是任何实际的目录客户端实现的一部分。</span><span class="sxs-lookup"><span data-stu-id="0a0db-445">This section describes a client concept that, although is not necessarily mandated by the protocol, should be part of any practical catalog client implementation.</span></span>

<span data-ttu-id="0a0db-446">由于目录是按时间编制索引的仅限追加的数据结构，因此客户端应在本地存储**游标**，这表示客户端处理目录项的时间点。</span><span class="sxs-lookup"><span data-stu-id="0a0db-446">Because the catalog is an append-only data structure indexed by time, the client should store a **cursor** locally, representing up to what point in time the client has processed catalog items.</span></span> <span data-ttu-id="0a0db-447">请注意，此游标值永远不应使用客户端的计算机时钟生成。</span><span class="sxs-lookup"><span data-stu-id="0a0db-447">Note that this cursor value should never be generated using the client's machine clock.</span></span> <span data-ttu-id="0a0db-448">相反，该值应来自目录对象的 `commitTimestamp` 值。</span><span class="sxs-lookup"><span data-stu-id="0a0db-448">Instead, the value should come from a catalog object's `commitTimestamp` value.</span></span>

<span data-ttu-id="0a0db-449">每当客户端想要处理包源上的新事件时，它只需查询其提交时间戳大于其存储游标的所有目录项的目录。</span><span class="sxs-lookup"><span data-stu-id="0a0db-449">Every time the client wants to process new events on the package source, it need only query the catalog for all catalog items with a commit timestamp greater than its stored cursor.</span></span> <span data-ttu-id="0a0db-450">当客户端成功处理所有新的目录项后，它会记录刚刚作为新的游标值处理的目录项的最新提交时间戳。</span><span class="sxs-lookup"><span data-stu-id="0a0db-450">After the client successfully processes all new catalog items, it records the latest commit timestamp of catalog items just processed as its new cursor value.</span></span>

<span data-ttu-id="0a0db-451">使用此方法，客户端可以确保永远不会错过包源上发生的任何包事件。</span><span class="sxs-lookup"><span data-stu-id="0a0db-451">Using this approach, the client can be sure to never miss any package events that occurred on the package source.</span></span>
<span data-ttu-id="0a0db-452">此外，客户端永远不需要在游标记录的提交时间戳之前重新处理旧事件。</span><span class="sxs-lookup"><span data-stu-id="0a0db-452">Additionally, the client never has to reprocess old events prior to the cursor's recorded commit timestamp.</span></span>

<span data-ttu-id="0a0db-453">这一功能强大的游标概念用于 nuget.org 后台作业，并用于使 V3 API 本身保持最新。</span><span class="sxs-lookup"><span data-stu-id="0a0db-453">This powerful concept of cursors is used for many of nuget.org background jobs and is used to keep the V3 API itself up-to-date.</span></span> 

### <a name="initial-value"></a><span data-ttu-id="0a0db-454">初始值</span><span class="sxs-lookup"><span data-stu-id="0a0db-454">Initial value</span></span>

<span data-ttu-id="0a0db-455">当目录客户端首次启动时（因此没有游标值），它应使用的默认游标值。NET `System.DateTimeOffset.MinValue` 或一些这种类似的最小表示时间戳概念。</span><span class="sxs-lookup"><span data-stu-id="0a0db-455">When the catalog client is starting for the very first time (and therefore has no cursor value), it should use a default cursor value of .NET's `System.DateTimeOffset.MinValue` or some such analogous notion of minimum representable timestamp.</span></span>

### <a name="iterating-over-catalog-items"></a><span data-ttu-id="0a0db-456">遍历目录项</span><span class="sxs-lookup"><span data-stu-id="0a0db-456">Iterating over catalog items</span></span>

<span data-ttu-id="0a0db-457">若要查询下一组要处理的目录项，客户端应：</span><span class="sxs-lookup"><span data-stu-id="0a0db-457">To query for the next set of catalog items to process, the client should:</span></span>

1. <span data-ttu-id="0a0db-458">从本地存储提取记录的游标值。</span><span class="sxs-lookup"><span data-stu-id="0a0db-458">Fetch the recorded cursor value from a local store.</span></span>
1. <span data-ttu-id="0a0db-459">下载并反序列化目录索引。</span><span class="sxs-lookup"><span data-stu-id="0a0db-459">Download and deserialize the catalog index.</span></span>
1. <span data-ttu-id="0a0db-460">查找提交时间戳*大于*游标的所有目录页。</span><span class="sxs-lookup"><span data-stu-id="0a0db-460">Find all catalog pages with a commit timestamp *greater than* the cursor.</span></span>
1. <span data-ttu-id="0a0db-461">声明要处理的目录项的空列表。</span><span class="sxs-lookup"><span data-stu-id="0a0db-461">Declare an empty list of catalog items to process.</span></span>
1. <span data-ttu-id="0a0db-462">对于步骤3中匹配的每个目录页：</span><span class="sxs-lookup"><span data-stu-id="0a0db-462">For each catalog page matched in step 3:</span></span>
   1. <span data-ttu-id="0a0db-463">下载并反序列化目录页。</span><span class="sxs-lookup"><span data-stu-id="0a0db-463">Download and deserialized the catalog page.</span></span>
   1. <span data-ttu-id="0a0db-464">查找提交时间戳*大于*游标的所有目录项。</span><span class="sxs-lookup"><span data-stu-id="0a0db-464">Find all catalog items with a commit timestamp *greater than* the cursor.</span></span>
   1. <span data-ttu-id="0a0db-465">将所有匹配目录项添加到步骤4中声明的列表。</span><span class="sxs-lookup"><span data-stu-id="0a0db-465">Add all matching catalog items to the list declared in step 4.</span></span>
1. <span data-ttu-id="0a0db-466">按提交时间戳对目录项列表进行排序。</span><span class="sxs-lookup"><span data-stu-id="0a0db-466">Sort the catalog item list by commit timestamp.</span></span>
1. <span data-ttu-id="0a0db-467">按顺序处理每个目录项：</span><span class="sxs-lookup"><span data-stu-id="0a0db-467">Process each catalog item in sequence:</span></span>
   1. <span data-ttu-id="0a0db-468">下载并反序列化目录项。</span><span class="sxs-lookup"><span data-stu-id="0a0db-468">Download and deserialize the catalog item.</span></span>
   1. <span data-ttu-id="0a0db-469">对目录项的类型做出适当的反应。</span><span class="sxs-lookup"><span data-stu-id="0a0db-469">React appropriately to the catalog item's type.</span></span>
   1. <span data-ttu-id="0a0db-470">以客户端特定的方式处理目录项文档。</span><span class="sxs-lookup"><span data-stu-id="0a0db-470">Process the catalog item document in a client-specific fashion.</span></span>
1. <span data-ttu-id="0a0db-471">将最后一个目录项的提交时间戳记录为新的游标值。</span><span class="sxs-lookup"><span data-stu-id="0a0db-471">Record the last catalog item's commit timestamp as the new cursor value.</span></span>

<span data-ttu-id="0a0db-472">使用此基本算法，客户端实现可以生成包源上可用的所有包的完整视图。</span><span class="sxs-lookup"><span data-stu-id="0a0db-472">With this basic algorithm, the client implementation can build up a complete view of all packages available on the package source.</span></span> <span data-ttu-id="0a0db-473">客户端只需要定期执行此算法，以便始终了解包源的最新更改。</span><span class="sxs-lookup"><span data-stu-id="0a0db-473">The client need only execute this algorithm periodically to always be aware of the latest changes to the package source.</span></span>

> [!Note]
> <span data-ttu-id="0a0db-474">这是 nuget.org 用于保持[包元数据](registration-base-url-resource.md)、[包内容](package-base-address-resource.md)、[搜索](search-query-service-resource.md)和[自动完成](search-autocomplete-service-resource.md)资源最新的算法。</span><span class="sxs-lookup"><span data-stu-id="0a0db-474">This is the algorithm that nuget.org uses to keep the [Package Metadata](registration-base-url-resource.md), [Package Content](package-base-address-resource.md), [Search](search-query-service-resource.md) and [Autocomplete](search-autocomplete-service-resource.md) resources up to date.</span></span>

### <a name="dependent-cursors"></a><span data-ttu-id="0a0db-475">依赖游标</span><span class="sxs-lookup"><span data-stu-id="0a0db-475">Dependent cursors</span></span>

<span data-ttu-id="0a0db-476">假设有两个目录客户端具有固有的依赖项，其中一个客户端的输出依赖于另一个客户端的输出。</span><span class="sxs-lookup"><span data-stu-id="0a0db-476">Suppose there are two catalog clients that have an inherent dependency where one client's output depends on another client's output.</span></span> 

#### <a name="example"></a><span data-ttu-id="0a0db-477">示例</span><span class="sxs-lookup"><span data-stu-id="0a0db-477">Example</span></span>

<span data-ttu-id="0a0db-478">例如，在 nuget.org 上，新发布的包在包元数据资源中出现之前不应出现在搜索资源中。</span><span class="sxs-lookup"><span data-stu-id="0a0db-478">For example, on nuget.org a newly published package should not appear in the search resource before it appears in the package metadata resource.</span></span> <span data-ttu-id="0a0db-479">这是因为官方 NuGet 客户端执行的 "还原" 操作使用包元数据资源。</span><span class="sxs-lookup"><span data-stu-id="0a0db-479">This is because the "restore" operation performed by the official NuGet client uses the package metadata resource.</span></span> <span data-ttu-id="0a0db-480">如果客户使用搜索服务发现包，他们应该能够使用包元数据资源成功还原该包。</span><span class="sxs-lookup"><span data-stu-id="0a0db-480">If a customer discovers a package using the search service, they should be able to successfully restore that package using the package metadata resource.</span></span> <span data-ttu-id="0a0db-481">换句话说，搜索资源依赖于包元数据资源。</span><span class="sxs-lookup"><span data-stu-id="0a0db-481">In other words, the search resource depends on the package metadata resource.</span></span> <span data-ttu-id="0a0db-482">每个资源都有一个更新该资源的目录客户端后台作业。</span><span class="sxs-lookup"><span data-stu-id="0a0db-482">Each resource has a catalog client background job updating that resource.</span></span> <span data-ttu-id="0a0db-483">每个客户端都有自己的游标。</span><span class="sxs-lookup"><span data-stu-id="0a0db-483">Each client has its own cursor.</span></span>

<span data-ttu-id="0a0db-484">由于这两个资源都是从目录中生成的，因此，更新搜索资源的目录客户端的游标*不得超出*包元数据目录客户端的光标。</span><span class="sxs-lookup"><span data-stu-id="0a0db-484">Since both resources are built off of the catalog, the cursor of the catalog client that updates the search resource *must not go beyond* the cursor of the package metadata catalog client.</span></span>

#### <a name="algorithm"></a><span data-ttu-id="0a0db-485">算法</span><span class="sxs-lookup"><span data-stu-id="0a0db-485">Algorithm</span></span>

<span data-ttu-id="0a0db-486">若要实现此限制，只需将上述算法修改为：</span><span class="sxs-lookup"><span data-stu-id="0a0db-486">To implement this restriction, simply modify the algorithm above to be:</span></span>

1. <span data-ttu-id="0a0db-487">从本地存储提取记录的游标值。</span><span class="sxs-lookup"><span data-stu-id="0a0db-487">Fetch the recorded cursor value from a local store.</span></span>
1. <span data-ttu-id="0a0db-488">下载并反序列化目录索引。</span><span class="sxs-lookup"><span data-stu-id="0a0db-488">Download and deserialize the catalog index.</span></span>
1. <span data-ttu-id="0a0db-489">查找提交时间戳\*大于\***或等于依赖项的游标**的所有目录页。</span><span class="sxs-lookup"><span data-stu-id="0a0db-489">Find all catalog pages with a commit timestamp *greater than* the cursor **less than or equal to the dependency's cursor.**</span></span>
1. <span data-ttu-id="0a0db-490">声明要处理的目录项的空列表。</span><span class="sxs-lookup"><span data-stu-id="0a0db-490">Declare an empty list of catalog items to process.</span></span>
1. <span data-ttu-id="0a0db-491">对于步骤3中匹配的每个目录页：</span><span class="sxs-lookup"><span data-stu-id="0a0db-491">For each catalog page matched in step 3:</span></span>
   1. <span data-ttu-id="0a0db-492">下载并反序列化目录页。</span><span class="sxs-lookup"><span data-stu-id="0a0db-492">Download and deserialized the catalog page.</span></span>
   1. <span data-ttu-id="0a0db-493">查找提交时间戳\*大于\***或等于依赖项的游标**的所有目录项。</span><span class="sxs-lookup"><span data-stu-id="0a0db-493">Find all catalog items with a commit timestamp *greater than* the cursor **less than or equal to the dependency's cursor.**</span></span>
   1. <span data-ttu-id="0a0db-494">将所有匹配目录项添加到步骤4中声明的列表。</span><span class="sxs-lookup"><span data-stu-id="0a0db-494">Add all matching catalog items to the list declared in step 4.</span></span>
1. <span data-ttu-id="0a0db-495">按提交时间戳对目录项列表进行排序。</span><span class="sxs-lookup"><span data-stu-id="0a0db-495">Sort the catalog item list by commit timestamp.</span></span>
1. <span data-ttu-id="0a0db-496">按顺序处理每个目录项：</span><span class="sxs-lookup"><span data-stu-id="0a0db-496">Process each catalog item in sequence:</span></span>
   1. <span data-ttu-id="0a0db-497">下载并反序列化目录项。</span><span class="sxs-lookup"><span data-stu-id="0a0db-497">Download and deserialize the catalog item.</span></span>
   1. <span data-ttu-id="0a0db-498">对目录项的类型做出适当的反应。</span><span class="sxs-lookup"><span data-stu-id="0a0db-498">React appropriately to the catalog item's type.</span></span>
   1. <span data-ttu-id="0a0db-499">以客户端特定的方式处理目录项文档。</span><span class="sxs-lookup"><span data-stu-id="0a0db-499">Process the catalog item document in a client-specific fashion.</span></span>
1. <span data-ttu-id="0a0db-500">将最后一个目录项的提交时间戳记录为新的游标值。</span><span class="sxs-lookup"><span data-stu-id="0a0db-500">Record the last catalog item's commit timestamp as the new cursor value.</span></span>

<span data-ttu-id="0a0db-501">使用此修改后的算法，可以生成依赖目录客户端的系统，所有这些客户端都生成其自己的特定索引、项目等。</span><span class="sxs-lookup"><span data-stu-id="0a0db-501">Using this modified algorithm, you can build a system of dependent catalog clients all producing their own specific indexes, artifacts, etc.</span></span>
